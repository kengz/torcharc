# modules:
#   mlp:
#     Sequential:
#       - LazyLinear:
#           out_features: 128
#       - ReLU:
#       - LazyLinear:
#           out_features: 128
#       - ReLU:
#       - LazyLinear:
#           out_features: 64
#       - ReLU:
#       - LazyLinear:
#           out_features: 32
#       - ReLU:
#   classifier:
#     LazyLinear:
#       out_features: 10

# the above is equivalent to the compact spec below

modules:
  mlp:
    compact:
      layer:
        type: LazyLinear
        keys: [out_features]
        args: [64, 64, 32, 16]
      postlayer:
        - ReLU:
  classifier:
    LazyLinear:
      out_features: 10

graph:
  input: x
  modules:
    # mlp: [x]
    # classifier: mlp
    classifier: [x]
  output: classifier
